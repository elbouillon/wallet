(function(){var t,e,n,i,o,a,s,r,u=function(t,e){return function(){return t.apply(e,arguments)}};n=function(){function t(){this._handleClick=u(this._handleClick,this);var t;t=$("[data-confirm]"),t.on("click",this._handleClick)}return t.prototype._handleClick=function(t){var e,n;if(e=$(t.currentTarget),(n=e.data("confirm"))&&!confirm(n))return t.preventDefault()},t}(),a=function(){function t(){Highcharts.setOptions({credits:{enabled:!1},lang:{contextButtonTitle:"Kontextové menu",decimalPoint:",",downloadCSV:"Stáhnout CSV",downloadJPEG:"Stáhnout JPEG",downloadPDF:"Stáhnout PDF",downloadPNG:"Stáhnout PNG",downloadSVG:"Stáhnout SVG",downloadXLS:"Stáhnout XLS",invalidDate:void 0,loading:"Načítám…",months:["Leden","Únor","Březen","Duben","Květen","Červen","Červenec","Srpen","Září","Říjen","Listopad","Prosinec"],noData:"Žádná data k zobrazení",numericSymbolMagnitude:1e3,numericSymbols:["k","M","G","T","P","E"],openInCloud:"Otevřít v Highcharts Cloud",printChart:"Tisknout",rangeSelectorFrom:"Od",rangeSelectorTo:"Do",rangeSelectorZoom:"Zoom",resetZoom:"Vyresetovat zoom",resetZoomTitle:"Vyresetovat zoom na 1:1",shortMonths:["Led","Úno","Bře","Dub","Kvě","Čvn","Čvc","Spr","Zář","Říj","Lis","Pro"],shortWeekdays:void 0,thousandsSep:" ",weekdays:["Neděle","Pondělí","Úterý","Středa","Čtvrtek","Pátek","Sobota"]}})}return t}(),i=function(){function t(){this._handleTagCombinationClick=u(this._handleTagCombinationClick,this),this._handleCopyAccountedOn=u(this._handleCopyAccountedOn,this),this._handleAmountInput=u(this._handleAmountInput,this),this._handleIncomeButtonClick=u(this._handleIncomeButtonClick,this),this._handleExpenseButtonClick=u(this._handleExpenseButtonClick,this),this.expenseButton=$(".js-expense"),this.expenseButton.length&&(this.incomeButton=$(".js-income"),this.amount=$(".js-amount"),this.accountedOnInput=$("#entry-accounted_on"),this.dateInput=$("#entry-date"),this.copyAccountedOn=$(".js-copy-accounted-on"),this.tagCombinations=$(".js-tag-combination"),this.expenseButton.on("click",this._handleExpenseButtonClick),this.incomeButton.on("click",this._handleIncomeButtonClick),this.amount.on("input",this._handleAmountInput),this.copyAccountedOn.on("click",this._handleCopyAccountedOn),this.tagCombinations.on("click",this._handleTagCombinationClick),this.select=$(".js-selectize").selectize())}return t.prototype._handleExpenseButtonClick=function(){var t;return t=Number(this.amount.val()),t>0&&this.amount.val(-t),this.amount.data("type","expense").focus(),this.expenseButton.addClass("btn-danger active").removeClass("btn-default"),this.incomeButton.removeClass("btn-success active").addClass("btn-default")},t.prototype._handleIncomeButtonClick=function(){var t;return t=Number(this.amount.val()),t<0&&this.amount.val(-t),this.amount.data("type","income").focus(),this.incomeButton.addClass("btn-success active").removeClass("btn-default"),this.expenseButton.removeClass("btn-danger active").addClass("btn-default")},t.prototype._handleAmountInput=function(){var t,e;if(""!==(e=this.amount.val()))return t=Number(e),"expense"===this.amount.data("type")&&t>0||"income"===this.amount.data("type")&&t<0?this.amount.val(-e):void 0},t.prototype._handleCopyAccountedOn=function(t){return t.preventDefault(),this.dateInput.val(this.accountedOnInput.val()).focus()},t.prototype._handleTagCombinationClick=function(t){var e,n;return t.preventDefault(),e=$(t.currentTarget),n=e.find("[data-tag-id]").map(function(t,e){return $(e).data("tag-id")}).toArray(),this.select[0].selectize.setValue(n)},t}(),r=function(){function t(){var t,e;t=$(".js-tags"),t.length&&(e=t.html(),t.sortable({axis:"y",containment:"parent",handle:".js-sortable-handle",tolerance:"pointer",update:function(){var n;if(n={},t.find("li").each(function(t){var e,i,o;if(i=t+1,e=$(this),o=e.data("position"),i!==o)return e.attr("data-position",i),n[e.data("id")]=i}),!$.isEmptyObject(n))return $.ajax(t.data("path"),{method:"POST",data:{positions:n},error:function(){return t.html(e)},success:function(){return e=t.html()}})}}))}return t}(),o=function(){function t(){this.element=$("#chart"),this.element.length&&this.init()}return t.prototype.init=function(){return $.getJSON(this.element.data("url"),function(t){var e;return t=t.map(function(t){return{name:t.name,data:[Number(t.sum)]}}),e={title:null,chart:{type:"column"},xAxis:{categories:["Výdaje"]},yAxis:{title:null},tooltip:{valueSuffix:" Kč"},series:t},Highcharts.chart("chart",e)})},t}(),e=function(){function t(){this._handleClick=u(this._handleClick,this),this.elements=$(".js-balance-diff"),this.elements.length&&(this.diff=$("#balance-diff"),this.items=[],this.elements.on("click",this._handleClick))}return t.prototype._handleClick=function(t){var e,n,i,o;return e=$(t.currentTarget),e.is(":checked")?(i=Date.parse(e.data("date")),n=Number(e.val()),o={input:e,amount:n,date:i},this._addItem(o),this._calculate()):void this._removeItem(e)},t.prototype._addItem=function(t){var e,n,i,o;switch(this.items.length){case 0:return this.items.push(t);case 1:return t.date>this.items[0].date?this.items.unshift(t):this.items.push(t);default:for(o=this.items,n=0,i=o.length;n<i;n++)e=o[n],e.input.prop("checked",!1);return this.items=[],this.items.push(t)}},t.prototype._removeItem=function(t){var e,n,i,o;for(o=this.items,n=0,i=o.length;n<i;n++)e=o[n],e.input.prop("checked",!1);return this.items=[],t.trigger("click")},t.prototype._calculate=function(){var t,e,n;return this.items.length<2?void this.diff.text(""):(t=this.items[0].amount-this.items[1].amount,e=parseFloat(t).toFixed(2).split("."),e[0]=e[0].replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1 "),n=e.join(",")+" Kč",t>=0&&(n="+"+n),this.diff.text(n))},t}(),t=function(){function t(){this.element=$("#balances-chart"),this.element.length&&this.init()}return t.prototype.init=function(){return $.getJSON(this.element.data("url"),function(t){return function(e){var n,i,o,a,s,r,u,c,l;for(c={total:{name:"Celkem",showInNavigator:!0,color:"#7cb5ec",lineWidth:4,type:"line",index:3,marker:{lineWidth:4,radius:6,lineColor:"#7cb5ec",fillColor:"white"},data:[]},incomes:{name:"Příjmy",showInNavigator:!1,color:"#108A00",type:"column",index:1,data:[]},expenses:{name:"Výdaje",showInNavigator:!1,color:"#C73C35",type:"column",index:2,data:[]}},s=0,r=e.length;s<r;s++)a=e[s],n=Date.parse(a.date),l=Number(a.total),o=Number(a.incomes),i=Number(a.expenses),c.total.data.push([n,l]),c.incomes.data.push([n,o]),c.expenses.data.push([n,i]);return u={type:"line",series:[c.total,c.incomes,c.expenses],rangeSelector:{buttons:[{type:"year",count:1,text:"Rok"},{type:"all",text:"Vše"}],selected:0,inputBoxWidth:100,inputDateFormat:"%B %Y",inputEditDateFormat:"%d. %m. %Y"},credits:{enabled:!1}},Highcharts.stockChart(t.element.attr("id"),u)}}(this))},t}(),s=function(){function t(){this.element=$("#tag-entries-chart"),this.element.length&&this.init()}return t.prototype.init=function(){return $.getJSON(this.element.data("url"),function(t){return function(e){var n,i,o,a,s,r,u,c;for(c={incomes:{name:"Příjmy",showInNavigator:!0,color:"#108A00",lineWidth:4,type:"line",index:1,marker:{lineWidth:4,radius:6,lineColor:"#7cb5ec",fillColor:"white"},data:[]},expenses:{name:"Výdaje",showInNavigator:!0,color:"#C73C35",lineWidth:4,type:"line",index:2,marker:{lineWidth:4,radius:6,lineColor:"#7cb5ec",fillColor:"white"},data:[]}},s=0,r=e.length;s<r;s++)a=e[s],n=Date.parse(a.date),o=Number(a.incomes),i=Number(a.expenses),c.incomes.data.push([n,o]),c.expenses.data.push([n,i]);return u={type:"line",series:[c.incomes,c.expenses],rangeSelector:{buttons:[{type:"year",count:1,text:"Rok"},{type:"all",text:"Vše"}],selected:0,inputBoxWidth:100,inputDateFormat:"%B %Y",inputEditDateFormat:"%d. %m. %Y"},credits:{enabled:!1}},Highcharts.stockChart(t.element.attr("id"),u)}}(this))},t}(),$(function(){return new n,new a,new i,new r,new o,new e,new t,new s})}).call(this);